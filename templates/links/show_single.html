{% extends "links/base.html" %}
{% load mptt_comments_tags %}
{% load staticfiles %}

{% block title %}
    lala
{% endblock %}

{% block headline %}
    lolo
{% endblock %}

{% block breadcrumb %}
    <li class="current"><a href="#">Index</a></li>
{% endblock %}

{% block content %}

  <div class="row">
    <div class="small-9 columns">
        <p>
          <ul class="inline-list">
            <li><a href="#" class="radius secondary label">Tag 1</a></li>
            <li><a href="#" class="radius secondary label">Tag 2</a></li>
            <li><a href="#" class="radius secondary label">Tag 3</a></li>
            <li><a href="#" class="radius secondary label">Tag 4</a></li>
            <li><a href="#" class="radius secondary label">Tag 5</a></li>
          </ul>
        </p>
    </div>
    <div class="small-3 columns text-right big-black-ic"><!-- FIXME: this is ugly. Need classes instead of inline styles. -->
        <a class="lsf symbol" id="bookmark" style="color:{% if 'Bookmarks' in titles %}#2ba6cb{%else%}black{%endif%}">addstar</a>
        <a class="lsf symbol" id="toread" style="color:{% if 'Reading list' in titles %}#2ba6cb{%else%}black{%endif%}">save</a>
        <a class="lsf symbol" href="{% url "ajax-own-lists" link.pk %}" data-reveal-id="add-to-list" data-reveal-ajax="true">list</a>
    </div>
  </div>

  <div class="row">
    <div class="large-12 columns">
      <h3><a href="{{ link.url }}">{{ link.title }}</a></h3>
      <p class="byline">
        {% with author=link.author %}
        by <a href="{% url "user-url" author.username %}">{{ author.username }}</a> | {{ link.pubdate|timesince }} ago
        {%endwith%}
      </p>
    </div>
  </div>


<div class="row">
  <div class="large-12 columns">
    <p>
    {% display_comment_toplevel_for link %}
    </p>
  </div>
</div>

{% endblock %}


{% block last_body %}
  <script>
  function add_to_default_list(list) {
    $("#"+list).css('color', '#bbb');
    $.ajax({
      type:"POST",
      url:"{% url "ajax_add_to_default_list" %}",
      data: 'csrfmiddlewaretoken={{csrf_token}}&lk={{ link.pk }}&t='+list,
      error: function(xhr) {
        result = $.parseJSON(xhr.response).result;
        if (result == 'added') {
          $("#"+list).css('color', '#2ba6cb');
        } else {
          $("#"+list).css('color', 'black');
        }
      }
    });
  }
  $("#bookmark").click(function() {
    add_to_default_list('bookmark');
  });
  $("#toread").click(function() {
    add_to_default_list('toread');
  });
  </script>

  {% mptt_comments_media_js %}
  <div id="add-to-list" class="small reveal-modal"></div>

  <div id="create-list" class="small reveal-modal">
    <form>
      <fieldset>
        <legend>Create a list</legend>
        <div class="row">
          <div class="large-4 columns">
            <label for="ordered">
              <input type="checkbox" id="ordered" name="ordered"> Ordered
            </label>
          </div>
          <div class="large-4 columns">
            <label for="private">
              <input type="checkbox" id="private" name="private"> Private
            </label>
          </div>
        </div>
        <div class="row">
          <div class="large-12 columns">
            <label for="private">
              <label>Title *</label>
              <input type="text" name="title">
            </label>
          </div>
        </div>

        <div class="row">
          <div class="large-12 columns">
            <label>Description</label>
            <textarea name="description" id="description" data-container="description"></textarea>
          </div>
        </div>
        <div class="row">
          <div class="large-12 columns">
            <input type="submit" class="button" value="Create" />
          </div>
        </div>
      </fieldset>
    </form>
    <a class="close-reveal-modal">&#215;</a>
  </div>
{% endblock last_body %}
