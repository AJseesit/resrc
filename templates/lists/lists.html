{% extends "lists/base.html" %}
{% load profile %}
{% load mptt_comments_tags %}

{% block title %}
Lists summary
{% endblock %}


{% block breadcrumb %}
<li><a href="{% url "home" %}">Home</a></li>
<li><a href="{% url "lists" %}">Lists</a></li>
<li class="current">Summary</li>
{% endblock %}

{% block content %}
<div class="row">
  <div class="large-12 columns">
    <h1>Lists</h1>
  </div>
</div>
<div class="row">
  <div class="medium-6 large-3 columns">
    <h3>latest</h3>
    <ul class="no-bullet">
      {% for list in latest %}
      <li><span class="views lsf">{{ list.views }}</span><a href="{% url "list-single-slug" list.pk list.slug %}">{{ list.title }}</a></li>
      <hr>
      {% endfor %}
    </ul>
  </div>
  <div class="medium-6 large-3 columns">
    <h3>most viewed</h3>
    <ul class="no-bullet">
      {% for list in most_viewed %}
      <li><span class="views lsf">{{ list.views }}</span><a href="{% url "list-single-slug" list.pk list.slug %}">{{ list.title }}</a></li>
      <hr>
      {% endfor %}
    </ul>
  </div>
  <div class="medium-6 large-3 columns">
    <h3>hottest</h3>
    <ul class="no-bullet">
      {% for list in hottest %}
      <li><span class="votes lsf" data-id="{{list.alist__pk}}">{{ list.count }}</span><a href="{% url "list-single-slug" list.alist__pk list.alist__slug %}">{{ list.alist__title }}</a></li>
      <hr>
      {% endfor %}
    </ul>
  </div>
  <div class="medium-6 large-3 columns">
    <h3>most appreciated</h3>
    <ul class="no-bullet">
      {% for list in most_voted %}
      <li><span class="votes lsf" data-id="{{list.alist__pk}}">{{ list.count }}</span><a href="{% url "list-single-slug" list.alist__pk list.alist__slug %}">{{ list.alist__title }}</a></li>
      <hr>
      {% endfor %}
    </ul>
  </div>
</div>

<div class="row">
  <div class="large-12 columns panel">
    <h6>legend</h6>
    <ul class="no-bullet inline-list">
      <li><a href="#"><span class="views lsf">23</span>I'm a list with 23 views</a></li>
      <li><a href="#"><span class="votes lsf" data-tooltip title="Click to upvote">74</span>I'm a list with 74 votes</a></li>
    </ul>
  </div>
</div>
{% endblock %}


{% block last_body %}
<script>
  $('.votes').click(function() {
    var button = $(this);
    var url = '/list/'+$(button).attr('data-id')+'/upvote';
    $.ajax({
      type:"POST",
      url: url,
      data: 'csrfmiddlewaretoken={{csrf_token}}',
      error: function(xhr) {
        result = $.parseJSON(xhr.response).result;
        if (result == 'success') {
          $(button).html(parseInt($(button).html(), 10)+1);
        }
      }
    });
  });
</script>
{% endblock last_body %}
